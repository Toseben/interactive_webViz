<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>A-Frame - Bank</title>
		<meta name="description" content="A-Frame - Bank">
		<script src="https://aframe.io/releases/0.3.2/aframe.min.js"></script>
		<script src="//cdn.rawgit.com/donmccurdy/aframe-extras/v2.7.2/dist/aframe-extras.min.js"></script>

	</head>
	<body>
	<script>

		var saveGeo, thisElement;

		// Component
		AFRAME.registerComponent('objloader', {
			schema: {
				color: { default: "blue" },
				obj: { default: "interiorBaked" }
			},

			init: function () {

				thisElement = this.el.object3D;
				var objName = this.data.obj;

				// Loading Manager //
				var l = new THREE.LoadingManager();

				l.onProgress = function (item, loaded, total) {
				    //console.log(item, loaded, total);
				};

				l.onLoad = function() {
		 			//console.log( 'Loading ' + objName + ' is done!' ); 
		 			thisElement.add(saveGeo);
				};

				// Loader //
				loader = new THREE.OBJLoader(l);

				var output = loader.load( "geo/" + objName + ".obj", function ( object ) {

					var material = new THREE.MeshBasicMaterial();
					loader = new THREE.TextureLoader();

					object.traverse( function ( child ) {
						child.material = material;
						child.material.map = loader.load( "img/" + objName + '_nonCompressed' + ".jpg" );
						saveGeo = child;
					} );

			    } );

				// WAT? //
			    var moi = new THREE.SphereGeometry( 0, 1, 1 );
			}
		});
	</script>

		<!-- Scene -->
		<a-scene physics="gravity: 0 debug: false" 
				 id='scene' 
				 fog="type: exponential; color: #AAB; density: 0.05">
			<!-- Camera -->
			  <a-entity camera universal-controls kinematic-body position='0 1.8 0'></a-entity>
			<!-- Geometry -->
			<a-entity static-body>
				<a-entity objloader='obj: ceilingBaked'></a-entity>
			</a-entity>

			<a-entity static-body>
				<a-entity objloader='obj: interiorBaked'></a-entity>
			</a-entity>
			<!-- Sky -->
			<a-sky color="#AAB"></a-sky>
		</a-scene>
	</body>
</html>